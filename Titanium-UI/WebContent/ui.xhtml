<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:icecore="http://www.icefaces.org/icefaces/core"
	xmlns:ace="http://www.icefaces.org/icefaces/components"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
<h:head>
	<title>Titanic</title>
	<ice:outputStyle href="./xmlhttp/css/rime/rime.css" />
	<link rel="stylesheet" type="text/css" href="resources/css/style.css" />
</h:head>
<h:body>
	<h:form>

		<f:view>
			<f:event listener="#{sessionBean.validate}" type="preRenderView" />
		</f:view>

		<ace:tabSet id="sampleTabSet" clientSide="false"
			binding="#{sessionBean.tabSet}"
			tabChangeListener="#{sessionBean.tabChange}"
			selectedIndex="#{sessionBean.selectedIndex}">

			<!-- ======== SCHEDULINGS VIEW ======== -->

			<ui:include src="schedulings-view.xhtml" />

			<!-- ======== INSTANCE LOG VIEW ======== -->

			<ui:include src="instance-log-view.xhtml" />

			<!-- ======== SCHEDULER VIEW ======== -->

			<ui:include src="scheduler-view.xhtml" />

			<!-- divider -->
			<ace:tabPane label="" disabled="true"
				rendered="#{sessionBean.user.authenticated}" />

			<!-- ======== DYNAMIC TABS ======== -->

			<ui:include src="dynamic-tabs.xhtml" />

			<!-- divider -->
			<ace:tabPane label="" disabled="true"
				rendered="#{sessionBean.user.authenticated}" />

			<!-- ======== HELP ======== -->

			<ui:include src="help.xhtml" />

			<!-- ======== LOG OUT ======== -->

			<ace:tabPane id="log_out" label="Log out"
				rendered="#{sessionBean.user.authenticated}" />


		</ace:tabSet>

		<!-- ========== SUBMIT MONITORS ========= -->

		<ace:submitMonitor for="refresh" activeLabel="Refreshing"
			autoCenter="true" blockUI="@source" />

		<ace:submitMonitor for="add_scheduling_monitor" activeLabel="Adding"
			autoCenter="true" blockUI="@source" />

		<ace:submitMonitor for="search_date" blockUI="@source"
			activeLabel="Searching" />

		<ace:submitMonitor for="tab_confirm_edit" activeLabel="Confirming"
			autoCenter="true" blockUI="@source" />

		<ace:submitMonitor for="run_schedulings_button" activeLabel="Running"
			autoCenter="true" blockUI="@all" />

		<ace:submitMonitor for="start_scheduler_button" activeLabel="Starting"
			autoCenter="true" blockUI="@all" />

		<ace:submitMonitor for="stop_scheduler_button" activeLabel="Stopping"
			autoCenter="true" blockUI="@all" />

		<ace:submitMonitor for="re_run_schedulings_button"
			activeLabel="Running" autoCenter="true" blockUI="@all" />

		<ace:submitMonitor for="re_run_all_button" activeLabel="Running"
			autoCenter="true" blockUI="@all" />

		<!--  ========== DIALOGS ========= -->


		<ace:confirmationDialog id="start_scheduler_service"
			widgetVar="start_scheduler_service_conf"
			message="You are about to start all schedulings. Write a short comment describing your actions."
			header="Confirm Start" width="330" height="300">
			<ace:textAreaEntry id="description"
				value="#{schedulerServiceManager.comment.text}"
				validator="#{schedulerServiceManager.ValidateInput}">
				<ace:ajax render="@this start_scheduler_service" event="blur" />
			</ace:textAreaEntry>
			<h:panelGrid width="100%">
				<h:message style="color: red;" id="inputError" for="description" />
			</h:panelGrid>
			<h:panelGrid columns="2">
				<h:commandButton id="start_scheduler_button" value="Confirm"
					disabled="#{schedulerServiceManager.confirmButtonDisabled}"
					onclick="start_scheduler_service_conf.hide()"
					actionListener="#{schedulerServiceManager.startAllSchedules}" />
				<h:commandButton value="Cancel"
					onclick="start_scheduler_service_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:confirmationDialog id="stop_scheduler_service"
			widgetVar="stop_scheduler_service_conf"
			message="You are about to stop all schedulings. Write a short comment describing your actions."
			header="Confirm Stop" width="330" height="300">
			<ace:textAreaEntry id="description2"
				value="#{schedulerServiceManager.comment2.text}"
				validator="#{schedulerServiceManager.ValidateInput}">
				<ace:ajax render="@this stop_scheduler_service" event="blur" />
			</ace:textAreaEntry>
			<h:panelGrid width="100%">
				<h:message style="color: red;" id="inputError2" for="description2" />
			</h:panelGrid>
			<h:panelGrid columns="2">
				<h:commandButton id="stop_scheduler_button" value="Confirm"
					onclick="stop_scheduler_service_conf.hide()"
					disabled="#{schedulerServiceManager.confirmButtonDisabled}"
					actionListener="#{schedulerServiceManager.stopAllSchedules}" />
				<h:commandButton value="Cancel"
					onclick="stop_scheduler_service_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:dialog visible="#{schedulerServiceManager.commentError}"
			rendered="#{schedulerServiceManager.commentError}" modal="true"
			resizable="false" header="Report" closable="false">
			<h:panelGrid columns="1">
				<h:outputText
					value="Comment field can't be empty. Nothing was done. Please open dialog again and fill in comment"
					styleClass="red" />
			</h:panelGrid>
			<ice:commandButton value="Close"
				actionListener="#{schedulerServiceManager.closeComment}" />
		</ace:dialog>

		<ace:confirmationDialog id="run_confirmation" widgetVar="run_conf"
			message="Are you sure you want to run following schedulings?"
			header="Confirm Run" width="330" height="300">
			<ice:outputText value="#{schedulingDataManager.schedulingList}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton id="run_schedulings_button" value="Yes"
					onclick="run_conf.hide()"
					actionListener="#{schedulingDataManager.runSelectedSchedules}" />
				<h:commandButton value="No" onclick="run_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:confirmationDialog id="resume_confirmation"
			widgetVar="resume_conf"
			message="Are you sure you want to resume following schedulings?"
			header="Confirm Resume" width="330" height="300">
			<ice:outputText value="#{schedulingDataManager.schedulingList}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton value="Yes" onclick="resume_conf.hide()"
					actionListener="#{schedulingDataManager.resumeSelected}" />
				<h:commandButton value="No" onclick="resume_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:confirmationDialog id="hold_confirmation" widgetVar="hold_conf"
			message="Are you sure you want to put following schedulings on hold?"
			header="Confirm Hold" width="330" height="300">
			<ice:outputText value="#{schedulingDataManager.schedulingList}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton value="Yes" onclick="hold_conf.hide()"
					actionListener="#{schedulingDataManager.holdSelected}" />
				<h:commandButton value="No" onclick="hold_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:confirmationDialog id="remove_confirmation"
			widgetVar="remove_conf"
			message="Are you sure you want to remove following schedulings?"
			header="Confirm Hold" width="330" height="300">
			<ice:outputText value="#{schedulingDataManager.schedulingList}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton value="Yes" onclick="remove_conf.hide()"
					actionListener="#{schedulingDataManager.removeSelected}" />
				<h:commandButton value="No" onclick="remove_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:dialog visible="#{schedulingDataManager.responseDialogVisible}"
			rendered="#{schedulingDataManager.responseDialogVisible}"
			modal="true" resizable="false" header="Report" closable="false">
			<h:panelGrid columns="1">
				<c:forEach items="#{schedulingDataManager.runReport}" var="report">
					<h:outputText value="#{report}" />
				</c:forEach>
			</h:panelGrid>
			<ice:commandButton value="Close"
				actionListener="#{schedulingDataManager.closeRunReport}" />
		</ace:dialog>

		<ace:confirmationDialog id="re_run_confirmation"
			widgetVar="re_run_conf"
			message="Are you sure you want to run following schedulings?"
			header="Confirm Run" width="330" height="300">
			<ice:outputText value="#{schedulingDataManager.schedulingList}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton id="re_run_schedulings_button" value="Yes"
					onclick="re_run_conf.hide()"
					actionListener="#{schedulingDataManager.runSelectedRuns}" />
				<h:commandButton value="No" onclick="re_run_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:confirmationDialog id="re_run_all_confirmation"
			widgetVar="re_run_all_conf"
			message="Are you sure you want to run following schedulings?"
			header="Confirm Run" width="330" height="300">
			<ice:outputText value="#{schedulingDataManager.schedulingList}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton id="re_run_all_button" value="Yes"
					onclick="re_run_all_conf.hide()"
					actionListener="#{schedulingDataManager.runAllRuns}" />
				<h:commandButton value="No" onclick="re_run_all_conf.hide()" />
			</h:panelGrid>
		</ace:confirmationDialog>

		<ace:dialog visible="#{schedulingDataManager.addSchedulingInf}"
			rendered="#{schedulingDataManager.addSchedulingInf}"
			id="add_confirmation" widgetVar="add_conf" header="Adding scheduling"
			width="330" height="150" closable="false">
			<ice:outputText value="#{schedulingDataManager.addSchedulingMessage}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton value="Ok"
					actionListener="#{schedulingDataManager.closeAddSchedulingInf}" />
			</h:panelGrid>
		</ace:dialog>

		<ace:dialog visible="#{schedulingDataManager.editSchedulingInf}"
			rendered="#{schedulingDataManager.editSchedulingInf}"
			id="edit_confirmation" widgetVar="edit_conf" header="Editing scheduling"
			width="330" height="150" closable="false">
			<ice:outputText value="#{schedulingDataManager.editSchedulingMessage}"
				escape="false" />
			<h:panelGrid columns="2">
				<h:commandButton value="Ok"
					actionListener="#{schedulingDataManager.closeEditSchedulingInf}" />
			</h:panelGrid>
		</ace:dialog>
	</h:form>
</h:body>
</html>