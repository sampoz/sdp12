<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:icecore="http://www.icefaces.org/icefaces/core"
	xmlns:ace="http://www.icefaces.org/icefaces/components"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
<h:head>
	<title>ICEfaces 3</title>
	<ice:outputStyle href="./xmlhttp/css/rime/rime.css" />
</h:head>
<h:body>
	<h:form>
		<style type="text/css">
.ui-datatable-odd {
	background-color: lightgray !important;
}

.left select {
	display: block;
}

.left label {
	display: block;
	float: left;
	margin-left: 10px
}

.left input:not (.iceCmdBtn ){
	display: block;
}

.red {
	color: red;
}
</style>
		<ace:tabSet id="sampleTabSet" clientSide="false">

			<ace:tabPane id="login_tab" label="Login">
				<h:panelGrid id="login_grid" columns="2"
					styleClass="centeredPanelWithBorderSpacingAndLeftJustifiedText">
					<h:outputLabel id="username_label" for="username_input"
						value="Username: " />
					<h:inputText id="username_input" />
					<h:outputLabel id="password_label" for="password_input"
						value="Password: " />
					<h:inputSecret id="password_input" />
					<ice:commandButton id="login_button" value="Login" />
				</h:panelGrid>
			</ace:tabPane>
			<ace:tabPane id="schedulings" label="Schedulings">

				<ace:menuBar>
					<ace:menuItem id="select_all" value="Select All"
						actionListener="#{dataMaster.selectAll}"
						icon="ui-icon ui-icon-check">
						<ace:ajax event="activate" execute="@this" />
					</ace:menuItem>
					<ace:menuItem id="deselect_all" value="Deselect All"
						actionListener="#{dataMaster.deselectAll}"
						icon="ui-icon ui-icon-closethick">
						<ace:ajax event="activate" execute="@this" />
					</ace:menuItem>
					<ace:menuItem id="start_selected" value="Start Selected"
						actionListener="#{dataMaster.stopSelected}"
						icon="ui-icon ui-icon-play">
						<ace:ajax event="activate" execute="@this" />
					</ace:menuItem>
					<ace:menuItem id="stop_selected" value="Stop Selected"
						actionListener="#{dataMaster.stopSelected}"
						icon="ui-icon ui-icon-pause">
						<ace:ajax event="activate" execute="@this" />
					</ace:menuItem>
					<ace:menuItem id="refresh" value="Refresh"
						actionListener="#{dataMaster.refresh}"
						icon="ui-icon ui-icon-refresh">
						<ace:ajax event="activate" execute="@this" />
					</ace:menuItem>
				</ace:menuBar>
				<ace:accordion id="accordion" collapsible="true" autoHeight="false"
					activeIndex="1">
					<ace:accordionPane id="addScheduling" title="Add Scheduling">
						<ice:outputText value="#{dataMaster.addErrorMessage}"
							rendered="#{dataMaster.addError}" styleClass="red" />

						<h:panelGrid id="addGrid" columns="6"
							styleClass="centeredPanelWithBorderSpacingAndLeftJustifiedText">
							<h:outputLabel id="nameLabel" for="nameInput" value="Name: " />
							<h:inputText id="nameInput" value="#{dataMaster.builder.name}" />
							<h:outputLabel id="descLabel" for="descInput"
								value="Description: " />
							<h:inputText id="descInput"
								value="#{dataMaster.builder.description}" />
							<h:outputLabel id="cronLabel" for="cronInput" value="CRON: " />
							<h:inputText id="cronInput" value="#{dataMaster.builder.cron}" />
							<h:outputLabel id="sourceLabel" for="sourceInput"
								value="Source: " />
							<h:selectOneMenu id="sourceInput"
								value="#{dataMaster.builder.source}">
								<f:selectItems value="#{dataMaster.backends}" />
								<f:converter converterId="entityConverter" />
							</h:selectOneMenu>
							<h:outputLabel id="targetLabel" for="targetInput"
								value="Target: " />
							<h:selectOneMenu id="targetInput"
								value="#{dataMaster.builder.target}">
								<f:selectItems value="#{dataMaster.backends}" />
								<f:converter converterId="entityConverter" />
							</h:selectOneMenu>
							<h:outputLabel id="modeLabel" for="modeInput" value="Mode: " />
							<h:selectOneMenu id="modeInput"
								value="#{dataMaster.builder.mode}">
								<f:selectItems value="#{dataMaster.modes}" />
								<f:converter converterId="entityConverter" />
							</h:selectOneMenu>
							<h:outputLabel id="bankLabel" for="bankInput" value="Holiday: " />
							<h:selectBooleanCheckbox id="bankInput"
								value="#{dataMaster.builder.bankHolidayOnly}" />

							<h:outputLabel id="javaLabel" for="javaInput" value="Pollable: " />
							<h:selectBooleanCheckbox id="javaInput"
								value="#{dataMaster.builder.javaAgentPollable}" />

							<h:outputLabel id="serviceLabel" for="compositeInput"
								value="Composite: " />
							<h:selectOneMenu id="compositeInput"
								value="#{dataMaster.builder.composite}">
								<f:selectItems value="#{dataMaster.composites}" />
								<f:converter converterId="entityConverter" />
							</h:selectOneMenu>
						</h:panelGrid>

						<ice:commandButton id="add_scheduling" value="Add Scheduling"
							actionListener="#{dataMaster.addScheduling}" />
					</ace:accordionPane>
				</ace:accordion>

				<ace:dataTable id="scheduleTable" value="#{dataMaster.schedulings}"
					var="schedule" paginator="true" paginatorPosition="bottom"
					rows="10" stateMap="#{dataMaster.stateMap}"
					selectionMode="multiple" resizableColumns="true"
					binding="#{dataMaster.dataTable}">
					<ace:ajax event="select" execute="@this" />


					<ace:column id="name" headerText="Name" sortBy="#{schedule.name}"
						filterBy="#{schedule.name}" filterMatchMode="contains">

						<h:outputText id="nameCell" value="#{schedule.name}" />

					</ace:column>


					<ace:column id="mode" headerText="Mode"
						sortBy="#{schedule.modeLabel}" filterBy="#{schedule.modeLabel}"
						filterMatchMode="contains">
						<ice:panelGroup style="width:100px;">
							<f:facet name="mode">
							Mode
						</f:facet>
						</ice:panelGroup>
						<h:outputText id="modeCell" value="#{schedule.modeLabel}" />

					</ace:column>

					<ace:column id="time" headerText="Time" sortBy="#{schedule.cron}"
						filterBy="#{schedule.cron}" filterMatchMode="contains">
						<ace:cellEditor>
							<f:facet name="output">
								<h:outputText id="timeCell" value="#{schedule.cron}" />
							</f:facet>
							<f:facet name="input">
								<h:inputText id="timeInput" value="#{schedule.cron}" />
							</f:facet>
						</ace:cellEditor>
					</ace:column>
					<ace:column id="cron_variables" headerText="Vars">
						<h:panelGrid id="icon_grid" columns="2">
							<h:graphicImage id="java_image" library="images"
								name="javaicon.png" style="height: 30px; width: 30px; "
								rendered="#{schedule.javaAgentPollable gt 0}" />
							<h:graphicImage id="bank_image" library="images"
								name="bankicon.jpg" style="height: 30px; width: 30px; "
								rendered="#{schedule.bankHolidayOnly gt 0}" />
						</h:panelGrid>

					</ace:column>
					<ace:column id="source" headerText="Source"
						sortBy="#{schedule.sourceName}" filterBy="#{schedule.sourceName}"
						filterMatchMode="contains">

						<h:outputText id="sourceCell" value="#{schedule.sourceName}" />
					</ace:column>

					<ace:column id="target" headerText="Target"
						sortBy="#{schedule.targetName}" filterBy="#{schedule.targetName}"
						filterMatchMode="contains">
						<h:outputText id="targetCell" value="#{schedule.targetName}"></h:outputText>


					</ace:column>

					<ace:column id="description" headerText="Description"
						sortBy="#{schedule.description}"
						filterBy="#{schedule.description}" filterMatchMode="contains">
						<ace:cellEditor>
							<f:facet name="output">
								<h:outputText id="descCell" value="#{schedule.description}" />
							</f:facet>
							<f:facet name="input">
								<h:inputText id="descInput" value="#{schedule.description}" />
							</f:facet>
						</ace:cellEditor>
					</ace:column>

					<ace:column id="edit" headerText="Edit">

						<ace:expansionToggler changeListener="#{dataMaster.expansion}" />

					</ace:column>

					<ace:panelExpansion>
						<ace:panel id="edit_panel" header="Edit" styleClass="left">
							<ice:outputText value="#{dataMaster.editErrorMessage}"
								rendered="#{dataMaster.editError}" styleClass="red"
								style="white-space:pre;" />
							<h:panelGrid id="editGrid" columns="6"
								styleClass="centeredPanelWithBorderSpacingAndLeftJustifiedText">
								<h:outputLabel id="editNameLabel" for="editNameInput"
									value="Name: " />
								<h:inputText id="editNameInput"
									value="#{dataMaster.editBuffer.get(schedule.id).name}" />
								<h:outputLabel id="editDescLabel" for="editDescInput"
									value="Description: " />
								<h:inputText id="editDescInput"
									value="#{dataMaster.editBuffer.get(schedule.id).description}" />
								<h:outputLabel id="editCronLabel" for="editCronInput"
									value="CRON: " />
								<h:inputText id="editCronInput"
									value="#{dataMaster.editBuffer.get(schedule.id).cron}" />
								<h:outputLabel id="editSourceLabel" for="editSourceInput"
									value="Source: " />
								<h:selectOneMenu id="editSourceInput"
									value="#{dataMaster.editBuffer.get(schedule.id).source}">
									<f:selectItems value="#{dataMaster.backends}" />
									<f:converter converterId="entityConverter" />
								</h:selectOneMenu>

								<h:outputLabel id="editTargetLabel" for="editTargetInput"
									value="Target: " />
								<h:selectOneMenu id="editTargetInput"
									value="#{dataMaster.editBuffer.get(schedule.id).target}">
									<f:selectItems value="#{dataMaster.backends}" />
									<f:converter converterId="entityConverter" />
								</h:selectOneMenu>
								<h:outputLabel id="editModeLabel" for="editModeInput"
									value="Mode: " />
								<h:selectOneMenu id="editModeInput"
									value="#{dataMaster.editBuffer.get(schedule.id).mode}">
									<f:selectItems value="#{dataMaster.modes}" />
									<f:converter converterId="entityConverter" />
								</h:selectOneMenu>

								<h:outputLabel id="editBankLabel" for="editBankInput"
									value="Holiday: " />
								<ice:selectBooleanCheckbox id="editBankInput"
									value="#{dataMaster.editBuffer.get(schedule.id).bankHolidayOnly}"
									partialSubmit="true" />
								<h:outputLabel id="editJavaLabel" for="editJavaInput"
									value="Pollable: " />
								<ice:selectBooleanCheckbox id="editJavaInput"
									value="#{dataMaster.editBuffer.get(schedule.id).javaAgentPollable}"
									partialSubmit="true" />
								<h:outputLabel id="editCompositeLabel" for="editCompositeInput"
									value="Composite: " />
								<h:selectOneMenu id="editCompositeInput"
									value="#{dataMaster.editBuffer.get(schedule.id).composite}">
									<f:selectItems value="#{dataMaster.composites}" />
									<f:converter converterId="entityConverter" />
								</h:selectOneMenu>

							</h:panelGrid>

							<br />
							<ice:commandButton id="confirm_edit" value="Confirm"
								actionListener="#{dataMaster.confirmEdit(schedule)}" />

							<ice:commandButton id="reset_edit" value="Reset"
								actionListener="#{dataMaster.resetEdit(schedule)}">
							</ice:commandButton>

						</ace:panel>

					</ace:panelExpansion>
				</ace:dataTable>



			</ace:tabPane>

			<ace:tabPane id="scheduling_log" label="Scheduling Log">

			</ace:tabPane>

			<ace:tabPane id="audit_log" label="Audit Log">

			</ace:tabPane>

		</ace:tabSet>

	</h:form>
</h:body>
</html>